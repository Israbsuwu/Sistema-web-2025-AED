{% extends 'vlastef_app/admin_panel/base.html' %}
{% load static %}

{% block title %}Detalle Categoría | Panel de Administración{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'vlastef_app/css/admin_panel/categoria_detalle.css' %}">
{% endblock %}

{% block main_content %}
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="categoria-detalle-panel">
        <div class="detalle-header">
            <h1 class="detalle-title">{{ categoria.nombre }}</h1>
            <a href="{% url 'admin_categorias' %}" class="btn-volver">Volver</a>
        </div>

        <div class="detalle-card">
            <div class="detalle-info">
                <p><strong>Descripción:</strong> {{ categoria.descripcion|default:'-' }}</p>
                <p><strong>Total de productos:</strong> {{ total_productos }}</p>
            </div>
        </div>

        <div class="productos-card">
            <h2 class="productos-title">Productos asociados</h2>
            {% if productos %}
                <div class="productos-grid">
                    {% for p in productos %}
                        <div class="producto-item">
                            <div class="producto-img">
                                {% if p.imagen %}
                                    <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}">
                                {% else %}
                                    <div class="no-imagen">Sin imagen</div>
                                {% endif %}
                            </div>
                            <div class="producto-info">
                                <div class="producto-id">ID: {{ p.id }}</div>
                                <div class="producto-nombre">
                                    <a class="producto-link" href="{% url 'admin_productos' %}?highlight={{ p.id }}">{{ p.nombre }}</a>
                                </div>
                                <div class="producto-descripcion">{{ p.descripcion|default:'-'|truncatechars:100 }}</div>
                                <div class="producto-qty">Cantidad: {{ p.cantidad_disponible }}</div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="no-productos">No hay productos asociados a esta categoría.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}
